<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>Using Physics in VE-Suite</title>

  <section>
    <title>Working with an Example</title>

    <para>VE-Suite's physics functionality makes representations of
    interactions in VE-Suite more realistic.</para>

    <para>To use VE-Suite's physics functionality, start VE-Suite as described
    in Chapter 3, Creating Content in VE-Suite. In VE-Conductor, go to the
    File menu and click Open ...</para>

    <para>Navigate to the directory where your file is located and, in Files
    of Type, select <code>*.ves</code>. Select the appropriate file (to
    demonstrate the physics functionality, we use
    <code>simple_physics_boxes.ves</code>, which is located in the
    <code>share/vesuite/examples/simple</code> directory) and click
    Open.</para>

    <para>The visualization will open in the VE-Xplorer window. Use the Frame
    All and other keyboard and mouse commands to change the view (see Chapter
    3.3 for navigation instructions).</para>

    <para>For each new file that is loaded in VE-Suite, the physics must be
    enabled. To do this, right-click on the plugin and click on Enable
    Physics.</para>

    <para>The physics functionality must also be turned on in VE-Conductor. To
    do this, click on the Physics On/Off button in the VE-Conductor
    toolbar.</para>

    <para>In addition to the Physics On/Off button, there are five more
    buttons in the Conductor toolbar that can be used to manipulate a
    visualization. The Start Simulation button starts the simulation.</para>

    <para>The toolbar also allows you to view the simulation step by step
    rather than all at once. To view one step of the simulation at a time,
    click the Step Simulation button.</para>

    <para>To reset the simulation to its original position, click the Reset
    Simulation button.</para>

    <para>When running longer simulations, you might want to pause the
    simulation while it is running. To do so, click the Pause Simulation
    button.</para>

    <para>The physics capability in VE-Suite also includes a Character
    Controller. To demonstrate the Character Controller, we will use the
    <code>character_demo.ves</code> file (also located in the
    <code>share/vesuite/examples/simple</code> directory).</para>

    <para>After loading the character_demo.ves file, click on the Character
    Controller button in Conductor.</para>

    <para>Use the Frame All and other keyboard and mouse commands to change
    the view (see Chapter 3.3 for navigation instructions).</para>

    <para>The tables below provide keyboard and mouse commands for interacting
    with the visualization in character mode.</para>

    <para><table>
        <title>Keyboard Commands</title>

        <tgroup cols="2">
          <tbody>
            <row>
              <entry>A</entry>

              <entry>Strafe left</entry>
            </row>

            <row>
              <entry>S</entry>

              <entry>Walk/Run backward</entry>
            </row>

            <row>
              <entry>W</entry>

              <entry>Walk/Run forward</entry>
            </row>

            <row>
              <entry>D</entry>

              <entry>Strafe right</entry>
            </row>

            <row>
              <entry>C</entry>

              <entry>Fly down (not implemented)</entry>
            </row>

            <row>
              <entry>Space Bar</entry>

              <entry>Jump/Fly up (not implemented)</entry>
            </row>
          </tbody>
        </tgroup>
      </table><table>
        <title>Mouse Commands</title>

        <tgroup cols="2">
          <tbody>
            <row>
              <entry>Left mouse button</entry>

              <entry>Rotate the camera about the xz-axes</entry>
            </row>

            <row>
              <entry>Left mouse button - mod:shift</entry>

              <entry>Physics picking using Bullet p2p constraint</entry>
            </row>

            <row>
              <entry>Middle mouse button - Scroll Up</entry>

              <entry>Zoom in to the character</entry>
            </row>

            <row>
              <entry>Middle mouse button</entry>

              <entry><emphasis>not currently used</emphasis></entry>
            </row>

            <row>
              <entry>Middle mouse button - Scroll Down</entry>

              <entry>Zoom out from the character</entry>
            </row>

            <row>
              <entry>Right mouse button</entry>

              <entry>Rotate the camera and the character about the
              xz-axes</entry>
            </row>
          </tbody>
        </tgroup>
      </table></para>
  </section>

  <section>
    <title>Creating Physics Data Step by Step</title>

    <para>This section will describe how to create physics data in VE-Suite
    using a simple example.</para>

    <para>First, load <code>simple.ves</code> in the same way you loaded
    <code>simple_physics_boxes.ves</code> in the previous section of this
    chapter. Right-click on DefaultPlugin in the VE-Conductor Network window
    and click on Geometry Config. This will open the CADTree Manager.</para>

    <para>Expand the Model_Geometry tree by clicking on the arrow. In this
    example, you should see three nodes: eightCorners, Surface0.75, and
    Surface0.75_cloned. Each node corresponds to a different part of the
    visualization: eightCorners corresponds to the bounding box, while
    Surface0.75 and Surface0.75_cloned each correponds to one of the white
    polygonal objects.</para>

    <para>Initialize physics on a node by right-clicking on it and selecting
    Initialize Physics. The CADTree Manager will open. Click on the Physics
    tab to set the Physics Properties (Mass, Friction, Restitution), Motion
    Type, LOD Type, Mesh Type, and Mesh Decimation). Each node must be
    initialized before physics can be run.</para>

    <para>Once you have initialized physics, the Initialize Physics option
    will no longer be available when you right-click on a node. To edit the
    physics properties of a node, right-click and select Properties... This
    will open the CADTree Manager with the Physics tab, where you can edit
    your previously set physics properties.</para>

    <para>Note: You must reset the simulation before editing a node's physics
    properties.</para>

    <para>Initializing physics on a node also enables you to pick up
    individual parts of a visualization and move them. Simply hold down the
    Shift key and left-click on the object to drag it within the plane of the
    screen.</para>
  </section>
</chapter>
