<?xml version="1.0" encoding="UTF-8"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook"
         xmlns:xlink="http://www.w3.org/1999/xlink"
         xmlns:xi="http://www.w3.org/2001/XInclude"
         xmlns:svg="http://www.w3.org/2000/svg"
         xmlns:m="http://www.w3.org/1998/Math/MathML"
         xmlns:html="http://www.w3.org/1999/xhtml"
         xmlns:db="http://docbook.org/ns/docbook">
  <title>Visualizations</title>

  <para>This chapter describes how to make visualizations using the VE-Suite
  toolkit and a sample dataset. To follow this example, download and unzip the
  PrISUm car dataset: <code><link
  xlink:href="http://www.vesuite.org/external/data/PrISUm.zip">PrISUm.zip</link></code>
  (57MB).</para>

  <section>
    <title>Setup</title>

    <para>Although visualizations only require a dataset file (which models
    the technical data), users may want to add a geometry file to the scene to
    view the physical object as well. Once the scene is set, visualization can
    be used to analyze the data. This chapter uses the PrISUm car example to
    demonstrate visualization.</para>

    <para>Load the geometry file. To do this, open VE-Launcher and set the
    Working Directory to the project's <code>PrISUm</code> directory. Next,
    use VE-Launcher to open VE-Suite in Desktop Mode. Load the geometry file,
    <code>PrISUmblend.obj</code>.</para>

    <para>Keep the CADTree Manager open. Right-click on the Model_Geometry
    directory and choose Properties. A CAD Properties window will open. This
    can be used to transform the file's dimensions. To fit PrISUm's geometry
    file with its dataset file, set the following values in the Transform
    tab:</para>

    <figure>
      <title>Transform the geometry file's dimensions</title>

      <mediaobject>
        <imageobject>
          <imagedata fileref="images/04-CADProperties.png"></imagedata>
        </imageobject>
      </mediaobject>
    </figure>

    <para>Once the parameters are entered, close the CAD Properties and
    CADTree Manager window. Next, you will need to load the datasets, the
    primary files for visualization.</para>
  </section>

  <section>
    <title>Datasets</title>

    <para>The dataset contains the technical data about the model, such as
    pressure and airflow. Visualization turns that data into a map for easier
    viewing. Datasets are loaded similar to the geometry configuration
    file.</para>

    <para>This figure shows the dialog box for loading datasets:</para>

    <figure>
      <title>Selecting a dataset</title>

      <mediaobject>
        <imageobject>
          <imagedata fileref="images/04-datasets-dialog.png"></imagedata>
        </imageobject>
      </mediaobject>
    </figure>

    <para>The following matrix outlines which filetypes are required for each
    type of dataset:</para>

    <table>
      <title>Required filetypes</title>

      <tgroup cols="3">
        <tbody>
          <row>
            <entry>Filetype</entry>

            <entry>Required files, column A</entry>

            <entry>Required files, column B</entry>
          </row>

          <row>
            <entry>VTK</entry>

            <entry></entry>

            <entry></entry>
          </row>

          <row>
            <entry>StarCD</entry>

            <entry>*.param</entry>

            <entry>*.cel, *.vrt, *.usr</entry>
          </row>

          <row>
            <entry>EnSight</entry>

            <entry>*.case</entry>

            <entry>*.flo, variable name</entry>
          </row>

          <row>
            <entry>MFIX</entry>

            <entry>*.mfix</entry>

            <entry></entry>
          </row>

          <row>
            <entry>Fluent</entry>

            <entry>*.cas</entry>

            <entry>*.dat</entry>
          </row>

          <row>
            <entry>AVS</entry>

            <entry>*.avs</entry>

            <entry></entry>
          </row>

          <row>
            <entry>Dicom</entry>

            <entry>*.dcm</entry>

            <entry></entry>
          </row>
        </tbody>
      </tgroup>
    </table>

    <para>The required files in column A reference the required files in
    column B. All files in columns A and B are required for loading the
    filetype in that row.</para>

    <para>To load a dataset in VE-Suite, right-click on the gray plugin box
    and click on Data Set Config.</para>

    <para>Click Add Dataset to create a new dataset and name it, then click
    Open under DataSet Filename and choose your dataset file (in this case,
    <code>prisum.vtk</code>). If you are just loading the PrISUm dataset,
    nothing else needs to be loaded, so click OK to load the dataset.</para>

    <para>If you need to load more information, you can do so through other
    fields. The Precomputed Data Directory and Surface Data Directory fields
    take data files created by the VE-Builder preprocessor to speed up
    calculations. The Volumetric Data Directories field takes texture-based
    data files.</para>

    <para><emphasis role="bold">NOTE:</emphasis> VE-Suite expects each type of
    precomputed data to be stored in a separate folder. Storing all of the
    precomputed data in one folder, or storing any of it in the Working
    Directory, will cause problems in the dataset.</para>

    <para>Finally, the dataset may need to be transformed to match up with the
    geometry data. The Transform button brings up a Transformation window,
    like the one used to transform the geometry data.</para>

    <para>The dataset does not need to be adjusted because the geometry
    objects were adjusted to fit it, so the Transform Input Window can be
    closed.</para>

    <para>Once the dataset files have been selected, click OK in the
    DataSetLoader window, then choose Submit Job from the Connection menu to
    display the PrISUm car. Use the navigation pane, the mouse, or the
    VE-Xplorer--&gt;View--&gt;Frame All command to adjust the camera until the
    view is satisfactory.</para>
  </section>

  <section>
    <title>Using Visualizations</title>

    <para>To use visualizations, go to the File menu in VE-Conductor, click
    Open, and select the appropriate .ves file. You might need to clear the
    design space by clicking on the New button in VE-Conductor.</para>

    <para><emphasis role="bold">NOTE:</emphasis> Make sure to save your work
    before clearning the design space.</para>

    <para>To bring up the visualization interface, right-click on the plugin
    to access the menu and select Visualization. The Visualization window will
    open.</para>

    <section>
      <title>Scalar Contours</title>

      <para>In the Visualization window, click on the Scalar Contours button
      to bring up the Contours interface.</para>

      <para>Set the direction (x, y, z, or By Wand) and choose the appropriate
      settings for Multiple Planes and Single Plane. Set the plane's position
      either using the text box or the slider.</para>

      <para>Click the Advanced... button to set further controls,
      including:</para>

      <itemizedlist>
        <listitem>
          <para>Warped Contour Scale opacity</para>
        </listitem>

        <listitem>
          <para>Contour LOD detail level</para>
        </listitem>

        <listitem>
          <para>Contour Type</para>
        </listitem>

        <listitem>
          <para>Warp Option, if applicable</para>
        </listitem>
      </itemizedlist>

      <para>Click Close when you are finished setting the advanced
      controls.</para>

      <para>When you are finished making the appropriate settings, click the
      Add Plane button, or click Close to go back to the Visualization
      interface.</para>
    </section>

    <section>
      <title>Vectors</title>

      <para>In the Visualization window, click the Vectors button to bring up
      the Vectors interface.</para>

      <para>Set the direction (x, y, z, By Wand, or All) and choose the
      appropriate settings for Multiple Planes and Single Plane. Select Use
      GPU Tools if applicable. Set the plane's position either using the text
      box or the slider.</para>

      <para>Click the Advanced... button to set further controls,
      including:</para>

      <itemizedlist>
        <listitem>
          <para>Vector Threshold</para>
        </listitem>

        <listitem>
          <para>Vector Scale</para>
        </listitem>

        <listitem>
          <para>Vector Ratio</para>
        </listitem>

        <listitem>
          <para>Scale by Vector Magnitude, if applicable</para>
        </listitem>
      </itemizedlist>

      <para>Click Close when you are finished setting the advanced
      controls.</para>

      <para>When you are finished making the appropriate settings, click the
      Add Plane button, or click Close to go back to the Visualization
      interface.</para>
    </section>

    <section>
      <title>Streamlines</title>

      <para>To show streamlines, click the Streamlines button in the
      Visualization interface. Set the integration direction and enable GPU
      tools if necessary.</para>

      <para>Click the Seed Points button to set seed point controls (X bounds,
      Y bounds, and Z bounds; X-Plane, Y-Plane, and Z-Plane). Click Close when
      you are finished setting seed point controls.</para>

      <para>Click the Advanced... button to set further controls,
      including:</para>

      <itemizedlist>
        <listitem>
          <para>Propogation Time</para>
        </listitem>

        <listitem>
          <para>Integration Step size</para>
        </listitem>

        <listitem>
          <para>Sphere/Arrow/Particle Size</para>
        </listitem>

        <listitem>
          <para>Line Diameter</para>
        </listitem>

        <listitem>
          <para>Fade Time</para>
        </listitem>

        <listitem>
          <para>Animation Speed</para>
        </listitem>
      </itemizedlist>

      <para>You can also use the checkboxes to use the last seed point, stream
      arrows or ribbon, or animate particles. Click Close when you are
      finished setting the advanced controls.</para>

      <para>When you are finished making the appropriate settings, click the
      Compute Streamline button, or click Close to go back to the
      Visualization interface.</para>
    </section>

    <section>
      <title>Isosurfaces</title>

      <para>To show isosurfaces, click the Isosurfaces button in the
      Visualization interface. Set the isosurfaces pressure.</para>

      <para>Click the Advanced... button to set further controls,
      including:</para>

      <itemizedlist>
        <listitem>
          <para>Scalar to Color Isosurface</para>
        </listitem>

        <listitem>
          <para>Scalar Range</para>
        </listitem>
      </itemizedlist>

      <para>Click Close when you are finished setting the advanced
      controls.</para>

      <para>When you are finished making the appropriate settings, click the
      Compute Isosurface button, or click Close to go back to the
      Visualization interface.</para>
    </section>

    <section>
      <title>Texture-Based Datasets</title>

      <para>Texture-based data can be viewed by clicking the Texture Based
      button in the Visualization interface. The Texture-Based Tools interface
      offers the following options:</para>

      <itemizedlist>
        <listitem>
          <para>Scalar Data Tools: In the Scalar Tools window, set the type of
          scalar, number of slice planes, isosurface, and scalar range. Click
          Enable Isosurface if applicable and set the range. The Advanced...
          isosurface button is currently disabled.</para>
        </listitem>

        <listitem>
          <para>Vector Data Tools: There is currently no data available to use
          with these tools.</para>
        </listitem>

        <listitem>
          <para>Edit Region of Interest: In the Volume Clipping Bounds
          interface, set X Bounds, Y Bounds, and Z Bounds.</para>
        </listitem>

        <listitem>
          <para>Edit Transfer Functions: In the Transfer Functions interface,
          set the Base Look-Up Table and select Enable Phong Shading if
          applicable.</para>
        </listitem>

        <listitem>
          <para>Transient: From the Transient Controls interface, you can play
          or stop the time steps or go forward or backward one frame at a
          time.</para>
        </listitem>
      </itemizedlist>

      <para>Click OK to go back to the Visualization interface.</para>
    </section>

    <section>
      <title>Polydata</title>

      <para>Polydata can be viewed by clicking on the Polydata button in the
      Visualization interface. In the Polydata interface, you can:</para>

      <itemizedlist>
        <listitem>
          <para>Select Use Warped Surface if applicable</para>
        </listitem>

        <listitem>
          <para>Set the Scale Factor</para>
        </listitem>

        <listitem>
          <para>Select Use GPU Tools and Two Sided Lighting if
          applicable</para>
        </listitem>

        <listitem>
          <para>Set the level of Scalar Control</para>
        </listitem>

        <listitem>
          <para>Set the Opacity</para>
        </listitem>
      </itemizedlist>

      <para>Click the Advanced... button to select the scalar to color
      polydata, and click OK to save your setting or Cancel to go back to the
      Polydata interface without changing the setting.</para>

      <para>When you are finished making the appropriate settings, click the
      Update button, or click Close to go back to the Visualization
      interface.</para>
    </section>
  </section>
</chapter>
