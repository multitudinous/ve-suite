C*                 *****  COMMONBL.FTN  *****
C*
C***********************************************************************
C*    
C*   environmental constants
C*
        COMMON/RCON/  
     & PRESS, ! (1) absolute pressure        (Pa)
              ! (2) drop in riser            (Pa)
              ! (3) drop in cyclone          (Pa)
              ! (4) offset for drop in riser (Pa)

     & TBED , ! guessed average bed temperature (K)
     & TIN  , ! temperature of feed air (K)
     & TAMB , ! ambient temperature (K)
     & TFLU , ! flue gas recirculation temperature (K)
     & TWALL  ! water wall surface temperature (K)

        REAL*8 PRESS(4), TBED  , TIN   , TAMB , TFLU, TWALL
C*
C**********************************************************************
C*
C*  geometry
C*
        COMMON/RCONA/ 
     & AREA  , ! (K) cross sect. area in riser (m2)
     & HEIGHT, ! (K) local height in riser (m)
     & WIDTH , ! (K) local width in riser (m)
     & LENGTH, ! (K) local lenght in riser(m)
     & TAP   , ! (K) (1=tapered section,0=not tapered)
     & TUBE  , ! (K) ratio tube bundle surface to volume (m2/m3)
     & WALL    ! (K) ratio water wall to total wall (m2/m2)

       REAL*8 AREA(0:NK), HEIGHT(0:NK), WIDTH(0:NK),  LENGTH(0:NK), 
     &      TAP(0:NK) , TUBE(0:NK)  , WALL(0:NK)
C*
C*******************************************************************
C*
C*      boundary conditions
C*
         COMMON/RCONG/ 
     & ADDAIR, ! (K) additional feed air into riser (Nm3/s)
     & ADDFLU, ! (K) flue gas recirculation (Nm3/s)
     & FEED  , ! (M) solids feed flow (kg/s)       
     & CYCDAT  ! (10)  input data for cyclone

       REAL*8  ADDAIR(0:NK), ADDFLU(0:NK), FEED(NM), CYCDAT(10)  
C*
C**********************************************************************
C*
C*       gas properties
C*
        COMMON/RCONF/ 
     & ENTHAL, ! (J) enthalpy difference of T-273K of specy (J/mol)
     & ENTROP, ! (J) entropy of specy (J/molK)
     & HEATCG, ! (J) heat capacity of specy (J/molK)
     & HEATFM, ! (J) heat of formation of specy (J/mol)
     & MWG     ! (J) molar weight of specy (kg/mol)

       REAL*8  ENTHAL(NJ), ENTROP(NJ), HEATCG(NJ),  HEATFM(NJ),
     &      MWG(NJ)   
C*
C**********************************************************************
C*
C*      particle properties
C*
         COMMON/RCONL/ 
     & ATTCON, ! (M)    attrition constant (m/s)
     & COALM , ! (10)   coal analysis (see parameters)
     & XNVOL , !        N fraction in volatiles (-)
     & SPLTN , !        NO/N split of char N release, N2O/N = 1.-SPLTN
     & DIAM  , ! (I)    average particle diameter in class I (m)
     & FRGFAC, ! (M)    fragmentation fator (-)
     & HEATCP, ! (M)    heat capacity of solid (J/kgK)
     & MEAND , ! (M)    particle sauter diameter (m)
     & MESH  , ! (I)    lowest diameter in size class I (m)
     & MWS   , ! (5)    molar weight solids (see parameters)
     & RHOS  , ! (M)    solids density (kg/m3)
     & SPHR    ! (M)    solids sphericity (-)

       REAL*8  ATTCON(NM), COALM(10) , XNVOL     , SPLTN    ,
     &       DIAM(NI)  , FRGFAC(NM), HEATCP(NM), MEAND(NM), 
     &       MESH(0:NI), MWS(20)   , RHOS(NM),   SPHR(NM)
C*
C*****************************************************************
C*
C*        gas velocities
C*
         COMMON /RCONG2/
     & U     , ! (K) superficial gas velocity in riser (m/s)
     & UANNU , ! (K) gas velocity in annulus (m/s)
     & UBUBBL, ! (K) gas velocity in bubbles (m/s)
     & COANMX, ! (K) gas exchange rate core - annuls (m3/m3s)
     & COBUMX  ! (K) gas exchange rate core - bubbles (m3/m3s)
             
       REAL*8  U(0:NK)      , UANNU(0:NK)  , UBUBBL(0:NK),
     &      COANMX(0:NK) , COBUMX(0:NK) 
C*
C***********************************************************************
C*
C*    particle velocities
C*
      COMMON /RCONK1/
     & USOLID, ! (I,K,M) solids rising velocity in core (m/s)
     & USOLA   ! (I,K,M) solids falling velocity in annulus (m/s)

      REAL*8  USOLID(NI,0:NK,NM), USOLA(NI,0:NK,NM)
C*
C**********************************************************************
C*
C*  fluidization pattern vertical
C*
        COMMON/RCONB/ 
     & AEXPIN, ! (M)    exponential decay constant times gas velocity (1/s)
     & AEXPO , ! (M)    exponential decay constant (1/m)
     & BEDM  , ! (M)    mass of solid material in riser (kg)
     & BEDMAS, !        total solid mass in riser (kg)
     & ELFLUX, ! (I,M)  elutriaton flux (kg/m2s)
     & ENFLUX, ! (I,M)  entrainment flux (kg/m2s)
     & EPSSD , ! (I,M)  solid volume fraction in dense bed (-)
     & EPSSHM, ! (M)    homogeneous solid volume fraction (-)
     & EPSELU, ! (I,M)  solid volume fraction at infinity (-)
     & FCOMP,  ! (I,M)  compensation factor for non steady riser geometry (-)
     & TTT     ! (I,M)  average residence time of particle (s)

       REAL*8  AEXPIN(NM)   ,   AEXPO(NM)    , BEDM(NM)     , BEDMAS, 
     &      ELFLUX(NI,NM),   ENFLUX(NI,NM), EPSSD(NI,NM) , EPSSHM(NM), 
     &      EPSELU(NI,NM),   FCOMP(NI,NM), TTT(NI,NM)
C*
C***********************************************************************
C*
C*        fluidization pattern core annulus bubble
C*
        COMMON/RCONE/ 
     & CORAVG, ! average cross sectional fraction covered by core
     & EMUAVG  ! average cross sectional fraction covered by emulsion

      REAL*8  CORAVG(0:NK), EMUAVG(0:NK)
C*
C**********************************************************************
C*
C*          weight fractions of solids 
C*
         COMMON /CONC2/
     & PART  , ! (I,M)  class and material fraction in system (-)
     & SIVFED, ! (I,M)  class fractions in fragmentated feed flow (-) 
     & SIVIN0  ! (I,M)  class fractions in original feed flow (-)

       REAL*8  PART(NI,NM), SIVFED(NI,NM), SIVIN0(NI,NM) 
C*
C*       unweighted solid flows ( for linear equation matrix)
C*
        COMMON /CONC3/
     & BAGCL , ! (I,M)  unweighted flow of solids to filer (kg/s)
     & OVERCL, ! (I,M)  unweighted flow of solids to drain (kg/s)
     & RECCL , ! (I,M)  unweighted flow of solids recycled (kg/s)
     & REAKCL, ! (I,M)  unweighted reaction rate (kg/s)
     & FEEDCL  ! (I,M)  unweighted feed flow of solids (kg/s)

       REAL*8  BAGCL(NI,NM),  OVERCL(NI,NM), RECCL(NI,NM), 
     &       REAKCL(NI,NM), FEEDCL(NI,NM)
C*
C***********************************************************************
C*
C*       exit, cyclone
C*
        COMMON/RCOND1/
     & EFFTOP, ! (I,M)  exit separation efficiency (-)
     & EFFCYC  ! (I,M)  cyclone separation efficiency (-)

       REAL*8  EFFCYC(NI,NM), EFFTOP(NI,NM)
C*
C**********************************************************************
C*
C*            molar gas flows
C*
        COMMON/RCONG1/
     & YFEEDA, ! (K) molar flow of feed air (mol/s)
     & YFEEDF, ! (K) molar flow of recycled flue gas (mol/s)
     & YVOLA , ! (K) molar flow of volatiles from coal (mol/s)
     & YH2O  , ! (K) molar flow of water vapour from coal (mol/s)
     & YO2   , ! (K) oxygen need for volatiles formation (mols/s)
     & YOUT  , ! (K) outflow of gas to exit (mols/s)
     & YTOT  , ! (K) total flow in riser (mol/s)
     & YCORE , ! (K) total flow in core (mol/s)
     & YANNU , ! (K) total flow in annulus (mol/s)
     & YBUBB , ! (K) total flow in bubble (mol/s)
     & YCOAN , ! (K) cross flow from core to annulus (mol/s)
     & YANCO , ! (K) cross flow from annulus to core (mol/s)
     & YCOBU , ! (K) cross flow from core to bubble (mol/s)
     & YBUCO   ! (K) cross flow from bubble to core (mol/s)

       REAL*8 YFEEDA(NK) ,YFEEDF(NK) ,YVOLA(NK)  ,YH2O(NK)   ,YO2(NK),
     &       YOUT(NK), 
     &       YCORE(0:NK),YANNU(0:NK),YBUBB(0:NK),YTOT(0:NK),
     &       YCOAN(NK)  ,YANCO(NK)  ,YCOBU(NK)  ,YBUCO(NK)

C*
C**********************************************************************
C*
C*   molar gas fractions
C*
        COMMON/RCONGA/ 
     & XFEED , ! (J) molar gas fractions in feed (-)
     & XVOLA , ! (J)          "             volatiles (-)
     & XH2O  , ! (J)          "             water vapour (-)
     & XO2   , ! (J)          "             used oxygen (-)
     & XGAS    ! (J,K,P)      "             phases (core,annu,bubb) (-)

      REAL*8 XFEED(NJ)     , XVOLA(NJ)     , XH2O(NJ)      ,  XO2(NJ),
     &     XGAS(NJ,0:NK,NP)
C*
C*************************************************************************
C*
C*      particle mass flows in cells
C*
        COMMON /RCONK2/
     & MNETTO, ! (I,K,M) net flow through cell (kg/s)
     & MUP   , ! (I,K,M) mass flowing up   (kg/s)
     & MDWN  , ! (I,K,M)         "    down (kg/s)
     & MX    , ! (I,K,M) vertical mixing flow (kg/s)
     & MCA   , ! (I,K,M)              from core to annulus (kg/s)
     & MAC   , ! (I,K,M)              from annulus to core (kg/s)
     & MCAX  , ! (I,K,M) mixing flow between core and annulus (kg/s)
     & MINL  , ! (I,K,M) mass flow in (kg/s)
     & MOUT  , ! (I,K,M) mass flow out (kg/s)
     & MCYC  , ! (I,K,M) mass flow recycled from cyclone (kg/s)
     & MEHE  , ! (I,K,M) mass flow recycled from ext. heat exchg. (kg/s)
     & REHE    !         mass flow fraction which goes to external heat exch.

       REAL*8 MNETTO(NI,0:NK,NM) , MUP(NI,0:NK,NM) , MDWN(NI,0:NK,NM),
     &      MX(NI,0:NK,NM)     , MCA(NI,0:NK,NM),
     &      MAC(NI,0:NK,NM)    , MCAX(NI,0:NK,NM),
     &      MINL(NI,0:NK,NM)   , MOUT(NI,0:NK,NM),
     &      MCYC(NI,0:NK,NM)   , MEHE(NI,0:NK,NM), REHE
C*
C**********************************************************************
C*
C*  particle mass in cells
C*
        COMMON/RCONK/ 
     & MCOR  , ! (I,K,M) mass of class and material in core of cell (kg)
     & MANN    ! (I,K,M) mass of class and material in annulus of cell (kg)

      REAL*8  MCOR(NI,0:NK,NM), MANN(NI,0:NK,NM)
C*
C**********************************************************************
C*
C*           heat
C*
         COMMON/RCONM/ 
     & TEMP,   ! (K,P) local temperatures in core         (K)
     & ALFATB, !     heat transfer coefficient to tubes (W/m2K)
     & ALFAWL, !     heat transfer coefficient to wall  (W/m2K)
     & TEHE,   !     part. temp. reentering riser from the ext. heat exch. (K)
     & HTTUBE, !     heat transferred to freeboard tubes (W)  
     & HTWALL, !     heat transferred to water walls (W)  
     & HTGAS,  !     heat transferred into second duct (W)  
     & HTRECY  !     heat transferred to recirculation loop (W)  
       REAL*8 TEMP(0:NK,3),ALFATB,ALFAWL,TEHE,HTTUBE,HTWALL,HTGAS,HTRECY
C*
C**********************************************************************
C*
C* devolatilization + drying
C*
        COMMON/RCONI/ 
     & CONDRY , ! (I) drying constant of coal (1/s)
     & CONVOL , ! (I) devolatilization constant of coal (1/s)
     & TDRY   , ! (I) dry out time (s)
     & TDEVOL , ! (I) devolatilization time (s)
     & TMCH2O , ! water relaese rates in core cells (kg/s)
     & TMCVOL , ! volatile release rates in core cells (kg/s)
     & TMAH2O , ! water release rates in annulus cells (kg/s)
     & TMAVOL   ! volatile release rates in annulus cells (kg/s)

       REAL*8 CONDRY(NI)   , CONVOL(NI)   , TDRY(NI), TDEVOL(NI),
     &       TMCH2O(0:NK) , TMCVOL(0:NK) ,
     &       TMAH2O(0:NK) , TMAVOL(0:NK) 
C*
C**********************************************************************
C*
C*  combustion
C*
        COMMON/RCONH/ 
     & ACHAR,  !       kinetic coeff. for char comustion (kg/m2sPa)
     & ECHAR,  !       activation energy by univ. gas const. (K)
     & KDIFFU, !       diffusion coeff.   (m2/s)
     & CALVAL, !       calorific value of coal (J/kg)
     & COKCO,  ! (I,K) carbon concentration per coke class in core cell (kgC/kgCoke)
     & COKAN,  ! (I,K) carbon concentration per coke class in annular cell (kgC/kgCoke)
     & RRCOMB, ! (J,K,P) gas product rates of combustion/gasification (mol/s)
     & RRTCO , ! (I,K) core coal combustion rate per oxygen fraction (mol/kgs)
     & RRTAN , ! (I,K) annular coal combustion rate per oxygen fraction (mol/kgs)
     & RTWCO , ! (I) core C+H2O rate per H2O fraction (mol/kgs)
     & RTWAN , ! (I) annular C+H2O rate per H2O fraction (mol/kgs)
     & RTCCO , ! (I) core C+CO2 rate per CO2 fraction (mol/kgs)
     & RTCAN , ! (I) annular C+CO2 rate per CO2 fraction (mol/kgs)
     & RTHCO , ! (I) core C+H2 rate per H2 fraction (mol/kgs)
     & RTHAN , ! (I) annular C+H2 rate per H2 fraction (mol/kgs)
     & RRTOT , ! (I)   combustion rate of particle (mol/kgs)
     & PHICO , ! (I,K) core C/O2 ratio for coal combustion (-)
     & PHIAN   ! (I,K) annular C/O2 ratio for coal combustion (-)

       REAL*8 ACHAR, ECHAR, KDIFFU, CALVAL,       
     &      COKCO(NI,NK), COKAN(NI,NK), RRCOMB(NI,NK,2) , 
     &      RRTCO(NI,NK), RRTAN(NI,NK), RRTOT(NI), 
     &      RTWCO(NI), RTWAN(NI), RTCCO(NI), 
     &      RTCAN(NI), RTHCO(NI), RTHAN(NI), 
     &      PHICO(NI,NK), PHIAN(NI,NK)
C*
C**********************************************************************
C*
C* homogeneous gas reactions


C*
C**********************************************************************
C*
C* heterogeneous gas reactions
C*
         COMMON/RCONJ/ 
     & SBET,   ! BET surface (m2/g)
     & ALFMAX, ! maximum conversion (-)
     & KSUR,   ! sulphation constant (m/s)
     & XCACO3, ! CaCO3 content in limestone (-)
     & RSURE,  ! (K,P) sulfur retention rate (mol/s)
     & SUREF,  ! (J)  sulfur retention steciometry (-)
     & MCOK, ! (K,P) NO  char concentration in cell (kg/m3)
     & MCAO, ! (K,P) NO  lime concentration in cell (kg/m3)
     & MINR, ! (K,P) NO  inert concentration in cell (kg/m3)
     & MCOKD ! (K,P) N2O char concentration in cell (kg/m3) diam korr

       REAL*8 SBET, ALFMAX, KSUR, XCACO3, RSURE(NK,2),SUREF(NJ), 
     &      MCOK(NK,2), MCAO(NK,2), MINR(NK,2), MCOKD(NK,2)
C*
C**********************************************************************
C*
C*  numerics
C*
        COMMON/RCONN/ 
     & POSTPR,  ! gas postprocess if true, preprocess if false
     & WRTOUT,  ! write to disk indicator
     & WRTSCR   ! write to screen indicator

        LOGICAL POSTPR, WRTOUT(30), WRTSCR
C*
C**********************************************************************
C*
C* integers
C*
        COMMON /NUMA/  
     & KCO    , ! indicator for core in cell array                   RISER
     & KAN    , ! indicator for annulus in cell array                RISER
     & KBU    , ! indicator for bubble in cell array                 RISER
     & NCLASS , ! number of size classes
     & NCOMP  , ! number of compartments in data input 
     & NCYC   , ! number of cyclones
     & NCELL  , ! (K) number of cells in compartment defined
     & NCELLS , ! number of cells in riser
     & NBED   , ! highest cell in dense bed
     & NUMBER   ! number of input file

      INTEGER         KCO   , KAN   , KBU  ,
     &                NCLASS, NCOMP , NCYC , NCELL(NK),
     &                NCELLS, NBED  , NUMBER

         COMMON /NUMB/
     & KCOMMON, ! common variable for cell indikator
     & LINTEG , ! integration loop counter
     & LPOPUL , ! population loop counter
     & LENERG , ! energy loop counter
     & LMASS   , ! mass loop counter
     & CMP    , ! (6) pointer for 1=elutriation, 2=lime feed, 3=coal feed, 
                !             4=recycle entry, 5= ext. heat ex. entry
                !             6=riser exit 
     & STATUS , ! (I,M) fluidization status, fix bed, bub. bed, fast fl.
     & SEE    , ! (I,I,M) attrition affectance matrix
     & NNOZZ  , ! number of nozzles in distributor plate
     & OPTION   ! (20) program switches for options (see list in input file)

       INTEGER KCOMMON, LINTEG  , LPOPUL       , 
     &         LMASS  , LENERG  , CMP(6)       , STATUS(NI,NM), 
     &         SEE(NI,NI,NM)    , NNOZZ        , OPTION(NK)
C*
C**********************************************************************
C*
C*         text files
C*
      COMMON/CHARAC/  SPECY, FLNAME

      CHARACTER*4     SPECY(NJ)
      CHARACTER*12    FLNAME
C*
C***********************************************************************
