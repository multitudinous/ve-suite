#!/bin/bash

source __VE_SUITE_ENV_FILE_PLACEHOLDER__ 

function usage()
{
    echo "Usage: $0 -j <path to jconf file> [ -d ] [ -h ]"
    echo ""
    echo "  Options"
    echo ""
    echo "  -j : specify the path to a VR Juggler config file (required)"
    echo "  -d : enable desktop cluster control mode (optional)"
    echo "  -h : show this help info"
}

JCONF_FILE=""
DESKTOP_CLUSTER_CONTROL="no"

while getopts "j:dh" OPT
do
    case ${OPT} in
        j)
            JCONF_FILE="${OPTARG}"
            ;;
        d)
            DESKTOP_CLUSTER_CONTROL="yes"
            ;;
        h)
            usage
            exit 0
            ;;
        ?)
            usage
            exit 1
            ;;
    esac
done

if [ -z "${JCONF_FILE}" ]
then
    usage
    exit 1
fi

HOSTNAME=`hostname`

if [ -z $VES_LOG_LEVEL ]
then
    export VES_LOG_LEVEL=warning
fi

EXTRA_ARGS=""

if [ "${DESKTOP_CLUSTER_CONTROL}" = "yes" ]
then
    EXTRA_ARGS="--DesktopClusterControl"
fi

ves_xplorer --vrjmaster --jconf="${JCONF_FILE}" --VESRTT --VESLog=$VES_LOG_LEVEL --VESLogPath="${VES_PREFIX}"/debug."${HOSTNAME}".log ${EXTRA_ARGS}

